<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能衣柜管理系统</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- 侧边栏 -->
    <aside class="sidebar">
        <div class="logo">
            <i class="fas fa-tshirt"></i>
            <span>智能衣柜</span>
        </div>
        
        <nav class="nav-menu">
            <a href="#" class="nav-item active" data-page="wardrobe">
                <i class="fas fa-home"></i>
                <span>我的衣柜</span>
            </a>
            <a href="#" class="nav-item" data-page="upload">
                <i class="fas fa-cloud-upload-alt"></i>
                <span>添加衣服</span>
            </a>
            <a href="#" class="nav-item" data-page="statistics">
                <i class="fas fa-chart-pie"></i>
                <span>统计分析</span>
            </a>
            <a href="#" class="nav-item" data-page="favorites">
                <i class="fas fa-heart"></i>
                <span>我的收藏</span>
            </a>
            <a href="#" class="nav-item" data-page="outfit">
                <i class="fas fa-magic"></i>
                <span>搭配推荐</span>
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <div class="stats-summary">
                <div class="stat-item">
                    <span class="stat-value" id="total-count">0</span>
                    <span class="stat-label">件衣服</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="favorite-count">0</span>
                    <span class="stat-label">收藏</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- 主内容区 -->
    <main class="main-content">
        <!-- 顶部栏 -->
        <header class="top-bar">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-input" placeholder="搜索衣服...">
            </div>
            <div class="top-actions">
                <button class="btn-icon" title="刷新" onclick="loadClothes()">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>
        </header>

        <!-- 页面内容容器 -->
        <div id="page-container">
            <!-- 衣柜页面 -->
            <div id="wardrobe-page" class="page active">
                <!-- 筛选栏 -->
                <div class="filter-bar">
                    <div class="filter-group">
                        <label>类别</label>
                        <select id="filter-category" onchange="loadClothes()">
                            <option value="">全部</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>颜色</label>
                        <select id="filter-color" onchange="loadClothes()">
                            <option value="">全部</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>风格</label>
                        <select id="filter-style" onchange="loadClothes()">
                            <option value="">全部</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>季节</label>
                        <select id="filter-season" onchange="loadClothes()">
                            <option value="">全部</option>
                            <option value="春">春</option>
                            <option value="夏">夏</option>
                            <option value="秋">秋</option>
                            <option value="冬">冬</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>收藏</label>
                        <select id="filter-favorite" onchange="loadClothes()">
                            <option value="">全部</option>
                            <option value="true">已收藏</option>
                            <option value="false">未收藏</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary" onclick="clearFilters()">
                        <i class="fas fa-times"></i> 清除筛选
                    </button>
                    <button class="btn btn-primary" id="batch-mode-btn" onclick="toggleBatchMode()">
                        <i class="fas fa-check-square"></i> 批量管理
                    </button>
                </div>
                
                <!-- 批量操作栏 -->
                <div class="batch-actions-bar" id="batch-actions-bar" style="display: none;">
                    <div class="batch-selection">
                        <label class="checkbox-label">
                            <input type="checkbox" id="select-all" onchange="toggleSelectAll()">
                            <span>全选</span>
                        </label>
                        <span class="selected-count" id="selected-count">已选择 0 件</span>
                    </div>
                    <div class="batch-buttons">
                        <button class="btn btn-secondary" onclick="toggleBatchFavorite()">
                            <i class="fas fa-heart"></i> 批量收藏
                        </button>
                        <button class="btn btn-danger" onclick="batchDelete()">
                            <i class="fas fa-trash"></i> 批量删除
                        </button>
                        <button class="btn btn-secondary" onclick="cancelBatchMode()">
                            <i class="fas fa-times"></i> 取消
                        </button>
                    </div>
                </div>

                <!-- 衣服网格 -->
                <div class="clothes-grid" id="clothes-grid">
                    <!-- 动态生成 -->
                </div>

                <!-- 加载状态 -->
                <div class="loading" id="loading" style="display: none;">
                    <i class="fas fa-spinner fa-spin"></i>
                    <span>加载中...</span>
                </div>

                <!-- 空状态 -->
                <div class="empty-state" id="empty-state" style="display: none;">
                    <i class="fas fa-tshirt"></i>
                    <h3>衣柜空空如也</h3>
                    <p>点击"添加衣服"开始添加你的第一件衣服吧！</p>
                    <button class="btn btn-primary" onclick="showPage('upload')">
                        <i class="fas fa-plus"></i> 添加衣服
                    </button>
                </div>
            </div>

            <!-- 上传页面 -->
            <div id="upload-page" class="page">
                <div class="upload-container">
                    <div class="upload-area" id="upload-area">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3>拖拽图片到这里上传</h3>
                        <p>或点击下方按钮选择文件</p>
                        <input type="file" id="file-input" accept="image/*" multiple hidden>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-primary" id="select-file-btn" type="button">
                            <i class="fas fa-folder-open"></i> 选择图片
                        </button>
                    </div>
                    
                    <!-- 上传预览区域 -->
                    <div class="upload-preview" id="upload-preview" style="display: none;">
                        <h3>待上传的图片</h3>
                        <div class="preview-grid" id="preview-grid"></div>
                        <div class="upload-actions">
                            <label class="checkbox-label">
                                <input type="checkbox" id="auto-classify" checked>
                                自动AI分类
                            </label>
                            <button class="btn btn-primary" id="start-upload-btn" onclick="uploadFiles()">
                                <i class="fas fa-upload"></i> 开始上传
                            </button>
                        </div>
                    </div>

                    <!-- 上传进度 -->
                    <div class="upload-progress" id="upload-progress" style="display: none;">
                        <h3>上传进度</h3>
                        <div class="progress-list" id="progress-list"></div>
                    </div>
                </div>
            </div>

            <!-- 统计页面 -->
            <div id="statistics-page" class="page">
                <div class="stats-container">
                    <div class="stats-cards">
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-tshirt"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="stat-total">0</span>
                                <span class="stat-text">总衣服数</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon favorite"><i class="fas fa-heart"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="stat-favorites">0</span>
                                <span class="stat-text">收藏数</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon warning"><i class="fas fa-clock"></i></div>
                            <div class="stat-info">
                                <span class="stat-number" id="stat-unworn">0</span>
                                <span class="stat-text">超过30天未穿</span>
                            </div>
                        </div>
                    </div>

                    <div class="charts-container">
                        <div class="chart-card">
                            <h3>类别分布</h3>
                            <div class="chart" id="category-chart"></div>
                        </div>
                        <div class="chart-card">
                            <h3>最近穿着</h3>
                            <div class="recent-list" id="recent-list"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 收藏页面 -->
            <div id="favorites-page" class="page">
                <div class="clothes-grid" id="favorites-grid"></div>
            </div>

            <!-- 搭配推荐页面 -->
            <div id="outfit-page" class="page">
                <div class="outfit-container">
                    <!-- 搭配模式选择 -->
                    <div class="outfit-modes">
                        <div class="outfit-mode-card active" onclick="setOutfitMode('item')" id="mode-item">
                            <i class="fas fa-tshirt"></i>
                            <h3>基于单品推荐</h3>
                            <p>选择一件衣服，推荐搭配组合</p>
                        </div>
                        <div class="outfit-mode-card" onclick="setOutfitMode('occasion')" id="mode-occasion">
                            <i class="fas fa-calendar-alt"></i>
                            <h3>基于场合推荐</h3>
                            <p>选择场合，推荐完整穿搭</p>
                        </div>
                    </div>

                    <!-- 基于单品推荐 -->
                    <div class="outfit-section" id="item-based-section">
                        <h3><i class="fas fa-hand-pointer"></i> 选择基础单品</h3>
                        <div class="outfit-filters">
                            <select id="outfit-filter-category" onchange="loadOutfitBaseItems()">
                                <option value="">全部类别</option>
                                <option value="上衣">上衣</option>
                                <option value="裤子">裤子</option>
                                <option value="裙子">裙子</option>
                                <option value="外套">外套</option>
                            </select>
                        </div>
                        <div class="outfit-base-grid" id="outfit-base-grid">
                            <!-- 动态生成可选的基础单品 -->
                        </div>
                    </div>

                    <!-- 基于场合推荐 -->
                    <div class="outfit-section" id="occasion-based-section" style="display: none;">
                        <h3><i class="fas fa-map-marker-alt"></i> 选择场合</h3>
                        <div class="occasion-grid">
                            <div class="occasion-card" onclick="selectOccasion('日常休闲')">
                                <i class="fas fa-home"></i>
                                <span>日常休闲</span>
                            </div>
                            <div class="occasion-card" onclick="selectOccasion('上班通勤')">
                                <i class="fas fa-briefcase"></i>
                                <span>上班通勤</span>
                            </div>
                            <div class="occasion-card" onclick="selectOccasion('户外运动')">
                                <i class="fas fa-running"></i>
                                <span>户外运动</span>
                            </div>
                            <div class="occasion-card" onclick="selectOccasion('正式场合')">
                                <i class="fas fa-user-tie"></i>
                                <span>正式场合</span>
                            </div>
                            <div class="occasion-card" onclick="selectOccasion('约会')">
                                <i class="fas fa-heart"></i>
                                <span>约会</span>
                            </div>
                            <div class="occasion-card" onclick="selectOccasion('聚会')">
                                <i class="fas fa-users"></i>
                                <span>聚会</span>
                            </div>
                            <div class="occasion-card" onclick="selectOccasion('旅行')">
                                <i class="fas fa-plane"></i>
                                <span>旅行</span>
                            </div>
                        </div>
                        <div class="outfit-extra-filters">
                            <select id="outfit-season">
                                <option value="">不限季节</option>
                                <option value="春">春季</option>
                                <option value="夏">夏季</option>
                                <option value="秋">秋季</option>
                                <option value="冬">冬季</option>
                            </select>
                            <select id="outfit-style">
                                <option value="">不限风格</option>
                                <option value="休闲">休闲</option>
                                <option value="正式">正式</option>
                                <option value="运动">运动</option>
                                <option value="时尚">时尚</option>
                            </select>
                        </div>
                    </div>

                    <!-- 推荐结果区域 -->
                    <div class="outfit-result-section" id="outfit-result-section" style="display: none;">
                        <h3><i class="fas fa-magic"></i> 智能搭配推荐</h3>
                        <div class="outfit-result-content" id="outfit-result-content">
                            <!-- 动态生成推荐结果 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 详情弹窗 -->
    <div class="modal" id="detail-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="modal-body">
                <div class="detail-image">
                    <img id="detail-image" src="" alt="">
                    <button class="btn-icon transparent-toggle" onclick="toggleTransparent()" title="切换透明背景">
                        <i class="fas fa-magic"></i>
                    </button>
                </div>
                <div class="detail-info">
                    <div class="detail-header">
                        <h2 id="detail-type">衣服类型</h2>
                        <div class="detail-actions">
                            <button class="btn-icon" id="detail-favorite" onclick="toggleFavorite()">
                                <i class="far fa-heart"></i>
                            </button>
                            <button class="btn-icon" onclick="reclassifyItem()">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button class="btn-icon delete" onclick="deleteItem()">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="detail-tags" id="detail-tags"></div>
                    
                    <div class="detail-section">
                        <h4>基本信息</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">类别</span>
                                <span class="info-value" id="detail-category">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">颜色</span>
                                <span class="info-value" id="detail-color">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">风格</span>
                                <span class="info-value" id="detail-style">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">材质</span>
                                <span class="info-value" id="detail-material">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4>适合场景</h4>
                        <div class="tag-group">
                            <span class="tag-label">季节:</span>
                            <span id="detail-season">-</span>
                        </div>
                        <div class="tag-group">
                            <span class="tag-label">天气:</span>
                            <span id="detail-weather">-</span>
                        </div>
                        <div class="tag-group">
                            <span class="tag-label">场合:</span>
                            <span id="detail-occasion">-</span>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4>穿搭建议</h4>
                        <div class="matching-section" id="matching-section"></div>
                    </div>

                    <div class="detail-section">
                        <h4>描述</h4>
                        <p id="detail-description">-</p>
                    </div>

                    <div class="detail-footer">
                        <div class="wear-info">
                            <span>穿着次数: <strong id="detail-wear-count">0</strong></span>
                            <span>最后穿着: <strong id="detail-last-worn">从未</strong></span>
                        </div>
                        <button class="btn btn-primary" onclick="recordWear()">
                            <i class="fas fa-check"></i> 记录今日穿着
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 上传确认弹窗 -->
    <div class="modal" id="confirm-modal">
        <div class="modal-content confirm-modal-content">
            <button class="modal-close" onclick="closeConfirmModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="confirm-modal-header">
                <h2><i class="fas fa-edit"></i> 确认衣服信息</h2>
                <p class="confirm-subtitle">请检查并确认以下信息是否正确</p>
            </div>
            <div class="confirm-modal-body">
                <div class="confirm-image-section">
                    <img id="confirm-image" src="" alt="衣服预览">
                </div>
                <div class="confirm-form-section">
                    <!-- 类别（单选，必填） -->
                    <div class="form-group required">
                        <label>类别 <span class="required-mark">*</span></label>
                        <select id="confirm-category">
                            <option value="">请选择类别</option>
                            <option value="上衣">上衣</option>
                            <option value="裤子">裤子</option>
                            <option value="裙子">裙子</option>
                            <option value="外套">外套</option>
                            <option value="鞋子">鞋子</option>
                            <option value="帽子">帽子</option>
                            <option value="包包">包包</option>
                            <option value="配饰">配饰</option>
                        </select>
                    </div>
                    
                    <!-- 具体类型 -->
                    <div class="form-group">
                        <label>具体类型</label>
                        <input type="text" id="confirm-type" placeholder="如：T恤、牛仔裤、连衣裙">
                    </div>
                    
                    <!-- 颜色（多选，必填） -->
                    <div class="form-group required">
                        <label>颜色 <span class="required-mark">*</span></label>
                        <div class="multi-select" id="color-options">
                            <label class="checkbox-tag"><input type="checkbox" value="黑色"> 黑色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="白色"> 白色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="灰色"> 灰色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="红色"> 红色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="蓝色"> 蓝色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="绿色"> 绿色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="黄色"> 黄色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="橙色"> 橙色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="紫色"> 紫色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="粉色"> 粉色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="棕色"> 棕色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="米色"> 米色</label>
                            <label class="checkbox-tag"><input type="checkbox" value="牛仔蓝"> 牛仔蓝</label>
                            <label class="checkbox-tag"><input type="checkbox" value="其他"> 其他</label>
                        </div>
                    </div>
                    
                    <!-- 风格（多选，必填） -->
                    <div class="form-group required">
                        <label>风格 <span class="required-mark">*</span></label>
                        <div class="multi-select" id="style-options">
                            <label class="checkbox-tag"><input type="checkbox" value="休闲"> 休闲</label>
                            <label class="checkbox-tag"><input type="checkbox" value="正式"> 正式</label>
                            <label class="checkbox-tag"><input type="checkbox" value="运动"> 运动</label>
                            <label class="checkbox-tag"><input type="checkbox" value="时尚"> 时尚</label>
                            <label class="checkbox-tag"><input type="checkbox" value="街头"> 街头</label>
                            <label class="checkbox-tag"><input type="checkbox" value="复古"> 复古</label>
                            <label class="checkbox-tag"><input type="checkbox" value="简约"> 简约</label>
                            <label class="checkbox-tag"><input type="checkbox" value="优雅"> 优雅</label>
                            <label class="checkbox-tag"><input type="checkbox" value="甜美"> 甜美</label>
                            <label class="checkbox-tag"><input type="checkbox" value="通勤"> 通勤</label>
                        </div>
                    </div>
                    
                    <!-- 季节（多选，必填） -->
                    <div class="form-group required">
                        <label>季节 <span class="required-mark">*</span></label>
                        <div class="multi-select" id="season-options">
                            <label class="checkbox-tag"><input type="checkbox" value="春"> 春</label>
                            <label class="checkbox-tag"><input type="checkbox" value="夏"> 夏</label>
                            <label class="checkbox-tag"><input type="checkbox" value="秋"> 秋</label>
                            <label class="checkbox-tag"><input type="checkbox" value="冬"> 冬</label>
                        </div>
                    </div>
                    
                    <!-- 材质 -->
                    <div class="form-group">
                        <label>材质</label>
                        <input type="text" id="confirm-material" placeholder="如：棉、牛仔、皮革">
                    </div>
                    
                    <!-- 厚薄 -->
                    <div class="form-group">
                        <label>厚薄程度</label>
                        <select id="confirm-thickness">
                            <option value="">请选择</option>
                            <option value="薄款">薄款</option>
                            <option value="中等">中等</option>
                            <option value="厚款">厚款</option>
                        </select>
                    </div>
                    
                    <!-- 适合场合 -->
                    <div class="form-group">
                        <label>适合场合</label>
                        <div class="multi-select" id="occasion-options">
                            <label class="checkbox-tag"><input type="checkbox" value="日常休闲"> 日常休闲</label>
                            <label class="checkbox-tag"><input type="checkbox" value="上班通勤"> 上班通勤</label>
                            <label class="checkbox-tag"><input type="checkbox" value="户外运动"> 户外运动</label>
                            <label class="checkbox-tag"><input type="checkbox" value="正式场合"> 正式场合</label>
                            <label class="checkbox-tag"><input type="checkbox" value="约会"> 约会</label>
                            <label class="checkbox-tag"><input type="checkbox" value="聚会"> 聚会</label>
                            <label class="checkbox-tag"><input type="checkbox" value="旅行"> 旅行</label>
                        </div>
                    </div>
                    
                    <!-- 描述 -->
                    <div class="form-group">
                        <label>描述</label>
                        <textarea id="confirm-description" rows="3" placeholder="添加衣服描述..."></textarea>
                    </div>
                </div>
            </div>
            <div class="confirm-modal-footer">
                <button class="btn btn-secondary" onclick="closeConfirmModal()">
                    <i class="fas fa-times"></i> 取消
                </button>
                <button class="btn btn-primary" onclick="confirmAndSave()">
                    <i class="fas fa-check"></i> 确认保存
                </button>
            </div>
        </div>
    </div>

    <!-- Toast 提示 -->
    <div class="toast-container" id="toast-container"></div>

    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
